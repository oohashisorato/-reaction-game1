<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>スマホ版リアクション勝負</title>
<style>
  body {
    margin: 0;
    font-family: "Arial", sans-serif;
    text-align: center;
    background: linear-gradient(180deg, #1e1e2f, #2c3e50);
    color: white;
  }

  h1 {
    margin: 20px 0 10px;
    font-size: 2.2em;
    font-weight: bold;
    text-shadow: 2px 2px 6px #000;
  }

  #signal {
    font-size: 2.8em;
    margin: 5px;
    font-weight: bold;
    transition: 0.2s;
  }

  #signal.glow {
    color: #00ff99;
    text-shadow: 0 0 20px #00ff99;
  }

  #winner {
    font-size: 2em;
    margin: 10px;
    height: 2em;
  }

  /* スコアカード */
  #score {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 10px 0 20px;
  }

  .scoreCard {
    background: rgba(255,255,255,0.15);
    border-radius: 15px;
    padding: 10px 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    font-size: 1.2em;
  }

  /* プレイヤーエリア */
  .area {
    width: 50%;
    height: 45vh;
    float: left;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: 0.15s;
  }

  #p1 { background: rgba(255,80,80,0.4); }
  #p2 { background: rgba(80,120,255,0.4); }

  .area:active {
    transform: scale(0.97);
    filter: brightness(1.3);
  }

  .playerName {
    font-size: 2em;
    font-weight: bold;
    margin-bottom: 10px;
  }

  /* スタートボタン */
  #startBtn {
    font-size: 1.6em;
    padding: 15px 40px;
    margin: 20px 0;
    border: none;
    border-radius: 40px;
    background: linear-gradient(90deg, #0099ff, #66ccff);
    color: white;
    font-weight: bold;
    box-shadow: 0 6px 10px rgba(0,0,0,0.4);
    transition: 0.15s;
  }
  #startBtn:active {
    transform: scale(0.97);
    filter: brightness(0.85);
  }

</style>
</head>

<body>

<h1>リアクション勝負</h1>

<div id="signal">スタートを押してね</div>
<div id="winner"></div>

<div id="score">
  <div class="scoreCard">P1：<span id="p1score">0</span>勝</div>
  <div class="scoreCard">P2：<span id="p2score">0</span>勝</div>
</div>

<div id="p1" class="area">
  <div class="playerName">PLAYER 1</div>
</div>

<div id="p2" class="area">
  <div class="playerName">PLAYER 2</div>
</div>

<button id="startBtn" onclick="startGame()">再戦 / スタート</button>

<script>
  let ready = false;
  let gameFinished = false;
  let p1score = 0;
  let p2score = 0;

  const audioContext = new (window.AudioContext || window.webkitAudioContext)();

  function playBeep(freq, duration) {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    osc.connect(gain);
    gain.connect(audioContext.destination);
    osc.frequency.value = freq;
    osc.type = "square";
    gain.gain.value = 0.15;
    osc.start();
    setTimeout(() => osc.stop(), duration);
  }

  function goSound() { playBeep(950, 160); }
  function winSound() {
    playBeep(650, 150);
    setTimeout(() => playBeep(850, 150), 160);
  }

  function startGame() {
    const signal = document.getElementById("signal");

    signal.textContent = "待て…";
    signal.classList.remove("glow");
    document.getElementById("winner").textContent = "";

    gameFinished = false;
    ready = false;

    const delay = Math.random() * 3000 + 2000;

    setTimeout(() => {
      signal.textContent = "GO!";
      signal.classList.add("glow");
      ready = true;
      goSound();
    }, delay);
  }

  function handleTap(player) {
    if (gameFinished) return;
    if (!ready) {
      document.getElementById("winner").textContent = "フライング！";
      gameFinished = true;
      return;
    }

    document.getElementById("winner").textContent = player + " の勝ち！";
    winSound();
    gameFinished = true;

    if (player === "Player 1") {
      p1score++;
      document.getElementById("p1score").textContent = p1score;
    } else {
      p2score++;
      document.getElementById("p2score").textContent = p2score;
    }
  }

  document.getElementById("p1").addEventListener("touchstart", () => handleTap("Player 1"));
  document.getElementById("p2").addEventListener("touchstart", () => handleTap("Player 2"));
</script>

</body>
</html>